# include <stdio.h>
# include <errno.h>
# include <error.h>
# include <string.h>
# include <stdlib.h>
# include <unistd.h>

# include "rc4.c"
# include "printers.c"
# include "cracker.c"

/*

actual rc4 stream :

$ python -c 'import sys;from Crypto.Cipher import ARC4;c = ARC4.new("\xab\x71\x59\x61\x61\x10\x14\x53");sys.stdout.write(c.encrypt("\x00"*512))' | hd
00000000  c2 2d 23 18 58 b7 20 c7  95 6a c2 cb a9 4b 46 ab  |.-#.X. ..j...KF.|
00000010  d6 7b cf 35 8a a5 96 89  a6 eb 5e a6 64 5c b3 30  |.{.5......^.d\.0|
00000020  f0 a2 23 af 21 a4 1d d4  4e 8c 32 1c c9 27 dd 58  |..#.!...N.2..'.X|
00000030  bd df 96 19 58 9a c0 e3  54 d9 4b d5 13 cd 7b a3  |....X...T.K...{.|
00000040  0c 29 cf 03 22 1e 5a 1c  10 38 9b 65 16 5e fe 0b  |.)..".Z..8.e.^..|
00000050  f2 19 5b c6 19 26 6e 94  1e 3e 1d 2e 38 6d b1 6d  |..[..&n..>..8m.m|
00000060  a8 63 06 de 03 07 e8 2c  3f c1 6d 85 c7 da 13 bb  |.c.....,?.m.....|
00000070  74 9d de 4e 60 2f 4a 7c  9a 13 f0 88 ca f4 6a 25  |t..N`/J|......j%|
00000080  01 fb e3 8b 46 80 79 03  c4 48 99 81 13 7b 3f 24  |....F.y..H...{?$|
00000090  dc 75 4d cf 43 2c f4 e2  59 7a c9 e4 4a 20 29 3e  |.uM.C,..Yz..J )>|
000000a0  60 0a 02 59 01 b6 83 44  7f c6 6f 5f 8c 2c 22 bd  |`..Y...D..o_.,".|
000000b0  88 ac 29 65 c1 6c 91 66  be 4b 5a 66 f7 8a 63 0c  |..)e.l.f.KZf..c.|
000000c0  d2 04 36 ff 31 23 93 fb  d7 4f 42 f0 f5 a6 59 1c  |..6.1#...OB...Y.|
000000d0  08 a1 a1 16 5b 13 e6 d0  96 87 91 5d 8f 2c 93 c9  |....[......].,..|
000000e0  48 1f 18 fb 18 7f df f8  af 32 0a f3 3c 0f 5c be  |H........2..<.\.|
000000f0  ce c7 34 a4 77 ff ca 5b  0b ed d4 17 86 9e 85 60  |..4.w..[.......`|
00000100  37 45 6b 8e 4a 02 88 46  c9 19 97 8e 92 da 2a 64  |7Ek.J..F......*d|
00000110  81 b1 7f 69 7f 8d 37 4e  37 85 a1 08 ba 46 a3 6f  |...i..7N7....F.o|
00000120  cf 40 06 9b 01 59 b5 97  ce 9e 4d 6a bf 74 20 da  |.@...Y....Mj.t .|
00000130  68 2e ea 58 f6 c3 e7 99  48 70 33 d0 ba 9f e3 9c  |h..X....Hp3.....|
00000140  78 a6 3d d8 12 b2 ee 21  43 56 6b 92 f9 fc 1e 80  |x.=....!CVk.....|
00000150  bb 42 74 56 ed f3 8a 9e  06 4d ab 99 6b d7 93 35  |.BtV.....M..k..5|
00000160  63 a7 a2 72 af a7 dd f0  31 2b 06 03 aa b0 f7 df  |c..r....1+......|
00000170  58 8d 13 19 dc cd 26 de  00 e7 7c 33 23 90 21 5d  |X.....&...|3#.!]|
00000180  23 ca 9a 6a 6b 25 b1 05  10 a6 7c da 25 02 da 4b  |#..jk%....|.%..K|
00000190  56 7b 42 bb 9d 6c 61 b6  fe 90 76 61 7d d7 4e 48  |V{B..la...va}.NH|
000001a0  e6 65 e6 c0 20 98 59 dc  8e 51 fa 01 ef 1b 1e 55  |.e.. .Y..Q.....U|
000001b0  9e c4 5c 67 09 d0 11 97  b3 ce d1 12 b6 f6 7e df  |..\g..........~.|
000001c0  2f 95 9c 58 35 16 6f ff  91 10 d4 b5 c8 c2 d4 59  |/..X5.o........Y|
000001d0  5d ba fd ac 65 2d 3e 99  72 eb 02 eb 3b ce 73 0d  |]...e->.r...;.s.|
000001e0  1f be 5d 9f 74 93 2a ce  58 7a 03 91 c7 c3 2b dd  |..].t.*.Xz....+.|
000001f0  df 67 10 2c 13 ed 30 61  98 6c d3 73 3d 00 f7 7b  |.g.,..0a.l.s=..{|
00000200

my rc4 stream :

$ ./executable | hd
00000000  c2 00 23 00 58 b7 00 c7  00 6a 00 00 a9 4b 46 00  |..#.X....j...KF.|
00000010  00 00 cf 35 02 a5 00 89  a6 00 5e 00 64 00 00 30  |...5......^.d..0|
00000020  00 a2 23 00 21 00 00 d4  4e 8c 00 00 00 27 dd 58  |..#.!...N....'.X|
00000030  bd df 00 00 00 00 00 e3  54 d9 4b d5 13 00 00 00  |........T.K.....|
00000040  00 29 00 00 00 1e 00 1c  10 38 00 00 16 5e fe 0b  |.).......8...^..|
00000050  00 19 5b 00 19 00 6e 00  1e 3e 00 00 38 6d b1 6d  |..[...n..>..8m.m|
00000060  a8 63 06 00 03 07 00 00  00 00 6d 00 00 da 13 00  |.c........m.....|
00000070  00 9d 00 4e 00 00 00 00  9a 13 f0 00 ca f4 6a 25  |...N..........j%|
00000080  00 00 00 8b 00 00 79 00  00 00 00 00 00 00 00 24  |......y........$|
00000090  00 00 4d 00 00 2c f4 e2  00 7a 00 00 4a 00 29 3e  |..M..,...z..J.)>|
000000a0  00 0a 0e 00 01 00 00 44  00 c6 00 00 8c 00 22 bd  |.......D......".|
000000b0  88 ac 29 65 00 00 00 66  be 00 5a 00 00 02 63 0c  |..)e...f..Z...c.|
000000c0  00 00 36 ff 31 23 93 00  d7 4f 42 00 f5 00 59 00  |..6.1#...OB...Y.|
000000d0  00 a1 00 16 5b 13 e6 d0  00 87 00 00 8f 00 00 00  |....[...........|
000000e0  00 00 18 00 18 7f df f8  00 32 0a f3 00 00 5c be  |.........2....\.|
000000f0  ce 00 34 00 00 ff 00 00  00 ed d4 17 00 00 00 60  |..4............`|
00000100  37 00 6b 00 00 0e 00 46  c9 00 97 8e 00 da 00 64  |7.k....F.......d|
00000110  81 00 7f 69 7f 00 00 4e  37 00 00 00 ba 00 a3 00  |...i...N7.......|
00000120  00 40 00 00 00 59 00 97  00 9e 4d 00 00 74 00 da  |.@...Y....M..t..|
00000130  68 00 ea 00 00 c3 00 00  00 00 00 d0 ba 00 e3 9c  |h...............|
00000140  78 a6 3d d8 00 b2 00 21  00 0e 00 92 00 00 1e 80  |x.=....!........|
00000150  bb 00 74 0e ed f3 8a 00  00 4d 00 99 6b 00 93 00  |..t......M..k...|
00000160  63 a7 a2 72 af 00 b1 00  00 2b 00 03 00 b0 f7 00  |c..r.....+......|
00000170  58 00 13 00 00 cd 26 00  00 e7 7c 00 23 00 21 00  |X.....&...|.#.!.|
00000180  23 ca 00 6a 6b 00 b1 05  10 00 00 da 00 02 da 4b  |#..jk..........K|
00000190  0e 7b 42 bb 00 00 00 00  00 00 00 00 7d 00 4e 00  |.{B.........}.N.|
000001a0  e6 00 00 c0 00 98 00 00  00 51 fa 00 ef 00 1e 55  |.........Q.....U|
000001b0  00 c4 00 67 00 d0 00 97  b3 00 d1 00 00 f6 00 00  |...g............|
000001c0  00 00 00 00 35 16 00 ff  00 00 d4 00 c8 c2 00 00  |....5...........|
000001d0  00 ba fd ac 00 2d 3e 00  72 00 02 00 00 00 73 0d  |.....->.r.....s.|
000001e0  1f be 5d 00 74 93 00 00  00 7a 03 91 c7 c3 00 b1  |..].t....z......|
000001f0  00 00 10 00 13 00 00 00  00 00 00 00 3d 00 f7 00  |............=...|
00000200


WHAT THE FUCK ?

*/


int main(int argc, char * argv[])
{
  unsigned char * key = NULL;

  key = malloc(8*sizeof(unsigned char));
  memset(key,0,8*sizeof(unsigned char));
  memcpy(key,(unsigned char *)"\xab\x71\x59\x61\x61\x10\x14\x53",8);
  check_key(key);
  free(key);
  return EXIT_SUCCESS;
}
